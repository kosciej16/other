from som import MemoryDatabase


db = MemoryDatabase()
db.set("a", 10)
db.set("b", 10)
db.count(10)
db.count(20)
db.delete("a")
db.count(10)
db.set("b", 30)
db.count(10)


db = MemoryDatabase()
db.begin()
db.set("a", 10)
db.get("a")
db.begin()
db.set("a", 20)
db.get("a")
db.rollback()
db.get("a")
db.rollback()
db.get("a")

db = MemoryDatabase()
db.begin()
db.set("a", 30)
db.begin()
db.set("a", 40)
db.commit()
db.get("a")
db.rollback()

db = MemoryDatabase()
db.begin()
db.set("a", 50)
db.begin()
db.get("a")
db.set("a", 60)
db.begin()
db.delete("a")
db.get("a")
db.rollback()
db.get("a")
db.commit()
db.get("a")

db = MemoryDatabase()
db.set("a", 10)
db.begin()
db.count(10)
db.begin()
db.delete("a")
db.count(10)
db.rollback()
db.count(10)
